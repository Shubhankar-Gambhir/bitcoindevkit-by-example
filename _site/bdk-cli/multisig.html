<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Multisignature - BDK by Example</title> <meta name="Description" content="Exploring the bitcoindevkit through a series of examples"> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Multisignature | BDK by Example</title> <meta name="generator" content="Jekyll v4.1.1" /> <meta property="og:title" content="Multisignature" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Exploring the bitcoindevkit through a series of examples" /> <meta property="og:description" content="Exploring the bitcoindevkit through a series of examples" /> <link rel="canonical" href="http://localhost:4000/bdk-cli/multisig" /> <meta property="og:url" content="http://localhost:4000/bdk-cli/multisig" /> <meta property="og:site_name" content="BDK by Example" /> <meta property="og:image" content="http://localhost:4000/img/bitcoindevkit.svg" /> <meta property="og:image:height" content="100" /> <meta property="og:image:width" content="100" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="http://localhost:4000/img/bitcoindevkit.svg" /> <meta property="twitter:title" content="Multisignature" /> <script type="application/ld+json"> {"url":"http://localhost:4000/bdk-cli/multisig","image":{"height":100,"width":100,"url":"http://localhost:4000/img/bitcoindevkit.svg","@type":"imageObject"},"description":"Exploring the bitcoindevkit through a series of examples","headline":"Multisignature","@type":"WebPage","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> BDK by Example </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/bdk" class="nav-list-link">Rust</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/bdk/sync-descriptor" class="nav-list-link">Sync Balance of Descriptor</a></li><li class="nav-list-item "><a href="http://localhost:4000/bdk/generate-addresses" class="nav-list-link">Generate Addresses</a></li><li class="nav-list-item "><a href="http://localhost:4000/bdk/create-transaction" class="nav-list-link">Create a Transaction</a></li><li class="nav-list-item "><a href="http://localhost:4000/bdk/sign-transaction" class="nav-list-link">Sign a Transaction</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/bdk-cli" class="nav-list-link">Command Line</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/bdk-cli/getting-started" class="nav-list-link">Getting Started</a></li><li class="nav-list-item "><a href="http://localhost:4000/bdk-cli/basic-workflow" class="nav-list-link">Basic Workflow</a></li><li class="nav-list-item "><a href="http://localhost:4000/bdk-cli/man-pages" class="nav-list-link">Using the Man Pages</a></li><li class="nav-list-item "><a href="http://localhost:4000/bdk-cli/map-subcommands" class="nav-list-link">Map of Subcommands</a></li><li class="nav-list-item "><a href="http://localhost:4000/bdk-cli/example-wallet" class="nav-list-link">Example Wallet</a></li><li class="nav-list-item "><a href="http://localhost:4000/bdk-cli/generating-new-keys" class="nav-list-link">Generating new keys</a></li><li class="nav-list-item "><a href="http://localhost:4000/bdk-cli/syncing-wallet" class="nav-list-link">Syncing a Wallet</a></li><li class="nav-list-item "><a href="http://localhost:4000/bdk-cli/receiving-coins" class="nav-list-link">Receiving Coins</a></li><li class="nav-list-item active"><a href="http://localhost:4000/bdk-cli/multisig" class="nav-list-link active">Multisignature</a></li><li class="nav-list-item "><a href="http://localhost:4000/bdk-cli/sending-coins" class="nav-list-link">Sending Coins</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/bdk-jni" class="nav-list-link">Android</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/bdk-jni/getting-started" class="nav-list-link">Getting Started</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search BDK by Example" aria-label="Search BDK by Example" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/bdk-cli">Command Line</a></li> <li class="breadcrumb-nav-list-item"><span>Multisignature</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="building-a-2-of-2-multisig-transaction-using-psbts"> <a href="#building-a-2-of-2-multisig-transaction-using-psbts" class="anchor-heading" aria-labelledby="building-a-2-of-2-multisig-transaction-using-psbts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Building a 2-of-2 multisig transaction using PSBTs </h1> <p><br /></p> <p>The worflow for this is the following:</p> <ol> <li>Create individual wallets for all parties</li> <li>Create descriptor for the “common” wallet which will generate both receive addresses and enable signatures</li> <li>Create the initial unsigned Partially Signed Bitcoin Transaction (PSBT)</li> <li>Pass that psbt to Alice so she can sign it and produce an updated psbt</li> <li>Pass that new psbt to Bob so he can sign it as well</li> <li>Finalize the psbt</li> <li>Broadcast the transaction to the network</li> </ol> <p>First, let’s build our wallets.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Alice</span>
bdk-cli key generate <span class="nt">--entropy</span> 24
<span class="o">{</span>
  <span class="s2">"fingerprint"</span>: <span class="s2">"6926972a"</span>,
  <span class="s2">"mnemonic"</span>: <span class="s2">"pulp clinic battle blast crumble tube orphan jungle eye swing vessel save like club situate dash female august wall danger street there embrace robot"</span>,
  <span class="s2">"xprv"</span>: <span class="s2">"tprv8ZgxMBicQKsPeG1VL2QFVJKtXJUGhRMUR5oZkqhNnd6GeX671mZTkfz9omTyVHvoZ6WnmectqWf1Lz4FLXmqnohpyg7HD7Lt6BavNkTAt6B"</span>
<span class="o">}</span>

<span class="c"># Create xpub descriptor wallet for Alice</span>
bdk-cli wallet <span class="nt">--descriptor</span> <span class="s2">"wpkh(tprv8ZgxMBicQKsPeG1VL2QFVJKtXJUGhRMUR5oZkqhNnd6GeX671mZTkfz9omTyVHvoZ6WnmectqWf1Lz4FLXmqnohpyg7HD7Lt6BavNkTAt6B/84h/1h/0h/0/*)"</span> public_descriptor
<span class="o">{</span>
  <span class="s2">"external"</span>: <span class="s2">"wpkh([6926972a/84'/1'/0']tpubDCj3FLoMDHpcfex7esm3hRw5xie6jDzrKpdJ4mLD95wZLdUHXoiw9tJAamG7gaTJb4yiLyGAAKwQah8c2yAoyR5UXtyY6xW3n8vNoWZMmdM/0/*)#ymtz0gs6"</span>,
  <span class="s2">"internal"</span>: null
<span class="o">}</span>

<span class="c"># Bob</span>
bdk-cli key generate <span class="nt">--entropy</span> 24
<span class="o">{</span>
  <span class="s2">"fingerprint"</span>: <span class="s2">"a0ff6e5d"</span>,
  <span class="s2">"mnemonic"</span>: <span class="s2">"mistake hidden pull together affair card easily shell stumble wolf leisure swamp stamp error appear bachelor meat split negative feature slush disagree food control"</span>,
  <span class="s2">"xprv"</span>: <span class="s2">"tprv8ZgxMBicQKsPfFrtXpphYa3nrKfZEQK7UxQJi4oGWXAfhnhuFPa59R628kpptohy3qPsrjNpoVjfDhS8bcf2qdpgnwd4AdzrknrCCv8NSwR"</span>
<span class="o">}</span>

<span class="c"># Create xpub descriptor wallet for Bob</span>
bdk-cli wallet <span class="nt">--descriptor</span> <span class="s2">"wpkh(tprv8ZgxMBicQKsPfFrtXpphYa3nrKfZEQK7UxQJi4oGWXAfhnhuFPa59R628kpptohy3qPsrjNpoVjfDhS8bcf2qdpgnwd4AdzrknrCCv8NSwR/84h/1h/0h/0/*)"</span> public_descriptor
<span class="o">{</span>
  <span class="s2">"external"</span>: <span class="s2">"wpkh([a0ff6e5d/84'/1'/0']tpubDCqapM5b7JtmYwt1tcnPnk5e5Wqw6FKYsz1PutkRvmA6G653sCjFr4Qdhncgd4xTmG7BQgJtFkPCxP3jsS7byPUnDaS5FD3Ad7qoEfiamMe/0/*)#3fsvszk3"</span>,
  <span class="s2">"internal"</span>: null
<span class="o">}</span>
</code></pre></div></div> <p>Next, we need a public descriptor for the common wallet between Alice and Bob. The descriptors for these types of wallets often use miniscript, and so you’ll often need to find the exact miniscript needed for the type of locking script you wish to impose on the addresses your wallet will generate. Once place to do that is in the <a href="https://bitcoindevkit.org/bdk-cli/playground/">playground</a> on the bitcoindevkit website. Here we want a 2-of-2 multisig, which actually not to miniscript but to a simpler Pay to Witness Script Hash: <code class="language-plaintext highlighter-rouge">wsh(multi(2,Alice,Bob))</code>. We’ll start by building 3 versions of the wallet descriptors: a public one consisting of Alice and Bob’s <code class="language-plaintext highlighter-rouge">xpub</code>s, one where Alice has her <code class="language-plaintext highlighter-rouge">xprv</code> but doesn’t know Bob’s <code class="language-plaintext highlighter-rouge">xprv</code>, and a third one where Bob has Alice’s <code class="language-plaintext highlighter-rouge">xpub</code> and his <code class="language-plaintext highlighter-rouge">xprv</code>.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># wsh(multi(2,Alice,Bob))</span>
<span class="c"># descriptor for the public wallet (no xprv)</span>
<span class="s2">"wsh(multi(2,[6926972a/84'/1'/0']tpubDCj3FLoMDHpcfex7esm3hRw5xie6jDzrKpdJ4mLD95wZLdUHXoiw9tJAamG7gaTJb4yiLyGAAKwQah8c2yAoyR5UXtyY6xW3n8vNoWZMmdM/0/*,[a0ff6e5d/84'/1'/0']tpubDCqapM5b7JtmYwt1tcnPnk5e5Wqw6FKYsz1PutkRvmA6G653sCjFr4Qdhncgd4xTmG7BQgJtFkPCxP3jsS7byPUnDaS5FD3Ad7qoEfiamMe/0/*))"</span>

<span class="c"># Alice's private version of the descriptor</span>
<span class="s2">"wsh(multi(2,tprv8ZgxMBicQKsPeG1VL2QFVJKtXJUGhRMUR5oZkqhNnd6GeX671mZTkfz9omTyVHvoZ6WnmectqWf1Lz4FLXmqnohpyg7HD7Lt6BavNkTAt6B/84h/1h/0h/0/*,[a0ff6e5d/84'/1'/0']tpubDCqapM5b7JtmYwt1tcnPnk5e5Wqw6FKYsz1PutkRvmA6G653sCjFr4Qdhncgd4xTmG7BQgJtFkPCxP3jsS7byPUnDaS5FD3Ad7qoEfiamMe/0/*))"</span>

<span class="c"># Bob's private version of the descriptor</span>
<span class="s2">"wsh(multi(2,[6926972a/84'/1'/0']tpubDCj3FLoMDHpcfex7esm3hRw5xie6jDzrKpdJ4mLD95wZLdUHXoiw9tJAamG7gaTJb4yiLyGAAKwQah8c2yAoyR5UXtyY6xW3n8vNoWZMmdM/0/*,tprv8ZgxMBicQKsPfFrtXpphYa3nrKfZEQK7UxQJi4oGWXAfhnhuFPa59R628kpptohy3qPsrjNpoVjfDhS8bcf2qdpgnwd4AdzrknrCCv8NSwR/84h/1h/0h/0/*))"</span>
</code></pre></div></div> <p>From here we have all we need to generate the PSBTs and sign them. To generate receive addresses and construct the unsigned empty initial PSBT, all we need is the public version of the wallet, and so that’s what we’ll derive here:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># build common public wallet for multisig and generate receive address</span>
<span class="c"># note that this would have been the same address had we build the wallet using any of the 2 other descriptors above</span>
bdk-cli wallet <span class="nt">--descriptor</span> <span class="s2">"wsh(multi(2,[6926972a/84'/1'/0']tpubDCj3FLoMDHpcfex7esm3hRw5xie6jDzrKpdJ4mLD95wZLdUHXoiw9tJAamG7gaTJb4yiLyGAAKwQah8c2yAoyR5UXtyY6xW3n8vNoWZMmdM/0/*,[a0ff6e5d/84'/1'/0']tpubDCqapM5b7JtmYwt1tcnPnk5e5Wqw6FKYsz1PutkRvmA6G653sCjFr4Qdhncgd4xTmG7BQgJtFkPCxP3jsS7byPUnDaS5FD3Ad7qoEfiamMe/0/*))"</span> get_new_address
<span class="o">{</span>
  <span class="s2">"address"</span>: <span class="s2">"tb1qnvqrz66zce2c8mxeajjv3hfwnu2sehf5rjcg4m27lftphu3rtlnqrvgsmt"</span>
<span class="o">}</span>

<span class="c"># *Send testnet coins to address above to fund the wallet and verify they have confirmed</span>
<span class="c"># txid: 73a2aae654ce4176bb387e58b838682057be59fc69f8749279f4de5e062300b6</span>

<span class="c"># Generate unsigned PSBT</span>
<span class="c"># ***At this point we need the wallet to be funded and synced!***</span>
bdk-cli wallet <span class="nt">--descriptor</span> <span class="s2">"wsh(multi(2,[6926972a/84'/1'/0']tpubDCj3FLoMDHpcfex7esm3hRw5xie6jDzrKpdJ4mLD95wZLdUHXoiw9tJAamG7gaTJb4yiLyGAAKwQah8c2yAoyR5UXtyY6xW3n8vNoWZMmdM/0/*,[a0ff6e5d/84'/1'/0']tpubDCqapM5b7JtmYwt1tcnPnk5e5Wqw6FKYsz1PutkRvmA6G653sCjFr4Qdhncgd4xTmG7BQgJtFkPCxP3jsS7byPUnDaS5FD3Ad7qoEfiamMe/0/*))"</span> create_tx <span class="nt">--to</span> <span class="s2">"tb1qm5tfegjevj27yvvna9elym9lnzcf0zraxgl8z2:0"</span> <span class="nt">--send_all</span>
<span class="o">{</span>
  <span class="s2">"details"</span>: <span class="o">{</span>
    <span class="s2">"fees"</span>: 138,
    <span class="s2">"height"</span>: null,
    <span class="s2">"received"</span>: 0,
    <span class="s2">"sent"</span>: 10000,
    <span class="s2">"timestamp"</span>: 1613703354,
    <span class="s2">"transaction"</span>: null,
    <span class="s2">"txid"</span>: <span class="s2">"948b6d5220043c1343f5569c35c5b33ab7b6159e9c8da5edd0f160a8c711f25d"</span>
  <span class="o">}</span>,
  <span class="s2">"psbt"</span>: <span class="s2">"cHNidP8BAFIBAAAAAbYAIwZe3vR5knT4afxZvlcgaDi4WH44u3ZBzlTmqqJzAQAAAAD/////AYYmAAAAAAAAFgAU3RacollkleIxk+lz8my/mLCXiH0AAAAAAAEBKxAnAAAAAAAAIgAgmwAxa0LGVYPs2eykyN0unxUM3TQcsIrtXvpWG/IjX+YBBUdSIQJhHSuAC4OHocXzeQ0VSVQjaQuxrvTmkb6z0c03e8cO6iEDFeKxKo1lKpXfMZ3UNHaAKNCC+HkdE8E5kk9Epf1yldlSriIGAmEdK4ALg4ehxfN5DRVJVCNpC7Gu9OaRvrPRzTd7xw7qGGkmlypUAACAAQAAgAAAAIAAAAAAAAAAACIGAxXisSqNZSqV3zGd1DR2gCjQgvh5HRPBOZJPRKX9cpXZGKD/bl1UAACAAQAAgAAAAIAAAAAAAAAAAAAA"</span>
<span class="o">}</span>
</code></pre></div></div> <p>We now have an unsigned PSBT ready to be passed around to the signators. Alice takes the first round and signs using her private wallet. This is a different descriptor than in the previous step, so you’ll either need to delete your bdk cache (<code class="language-plaintext highlighter-rouge">rm -rf ~/.bdk-bitcoin/</code>) or name your wallets (see examples in previous sections for how to do just that).</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Round 1: Alice signs the psbt</span>
<span class="c"># ***Make sure Alice's new wallet is synced!***</span>
bdk-cli wallet <span class="nt">--descriptor</span> <span class="s2">"wsh(multi(2,tprv8ZgxMBicQKsPeG1VL2QFVJKtXJUGhRMUR5oZkqhNnd6GeX671mZTkfz9omTyVHvoZ6WnmectqWf1Lz4FLXmqnohpyg7HD7Lt6BavNkTAt6B/84h/1h/0h/0/*,[a0ff6e5d/84'/1'/0']tpubDCqapM5b7JtmYwt1tcnPnk5e5Wqw6FKYsz1PutkRvmA6G653sCjFr4Qdhncgd4xTmG7BQgJtFkPCxP3jsS7byPUnDaS5FD3Ad7qoEfiamMe/0/*))"</span> sign <span class="nt">--psbt</span> <span class="s2">"cHNidP8BAFIBAAAAAbYAIwZe3vR5knT4afxZvlcgaDi4WH44u3ZBzlTmqqJzAQAAAAD/////AYYmAAAAAAAAFgAU3RacollkleIxk+lz8my/mLCXiH0AAAAAAAEBKxAnAAAAAAAAIgAgmwAxa0LGVYPs2eykyN0unxUM3TQcsIrtXvpWG/IjX+YBBUdSIQJhHSuAC4OHocXzeQ0VSVQjaQuxrvTmkb6z0c03e8cO6iEDFeKxKo1lKpXfMZ3UNHaAKNCC+HkdE8E5kk9Epf1yldlSriIGAmEdK4ALg4ehxfN5DRVJVCNpC7Gu9OaRvrPRzTd7xw7qGGkmlypUAACAAQAAgAAAAIAAAAAAAAAAACIGAxXisSqNZSqV3zGd1DR2gCjQgvh5HRPBOZJPRKX9cpXZGKD/bl1UAACAAQAAgAAAAIAAAAAAAAAAAAAA"</span>
<span class="o">{</span>
  <span class="s2">"is_finalized"</span>: <span class="nb">false</span>,
  <span class="s2">"psbt"</span>: <span class="s2">"cHNidP8BAFIBAAAAAbYAIwZe3vR5knT4afxZvlcgaDi4WH44u3ZBzlTmqqJzAQAAAAD/////AYYmAAAAAAAAFgAU3RacollkleIxk+lz8my/mLCXiH0AAAAAAAEBKxAnAAAAAAAAIgAgmwAxa0LGVYPs2eykyN0unxUM3TQcsIrtXvpWG/IjX+YiAgJhHSuAC4OHocXzeQ0VSVQjaQuxrvTmkb6z0c03e8cO6kgwRQIhAIg27AX8O+bPl7sQE/akEzjj0ngULrlDqIUSNXHwkSfxAiB3vlBdoBqNIAnoTDhVkTT0I9zoiWv6+bsYWNMrYWS8GAEBBUdSIQJhHSuAC4OHocXzeQ0VSVQjaQuxrvTmkb6z0c03e8cO6iEDFeKxKo1lKpXfMZ3UNHaAKNCC+HkdE8E5kk9Epf1yldlSriIGAmEdK4ALg4ehxfN5DRVJVCNpC7Gu9OaRvrPRzTd7xw7qGGkmlypUAACAAQAAgAAAAIAAAAAAAAAAACIGAxXisSqNZSqV3zGd1DR2gCjQgvh5HRPBOZJPRKX9cpXZGKD/bl1UAACAAQAAgAAAAIAAAAAAAAAAAAAA"</span>
<span class="o">}</span>
<span class="c"># notice how the psbt is now bigger than it was before Alice signed it</span>

<span class="c"># Bob signs the psbt</span>
<span class="c"># ***Make sure Bob's wallet is synced!***</span>
bdk-cli wallet <span class="nt">--descriptor</span> <span class="s2">"wsh(multi(2,[6926972a/84'/1'/0']tpubDCj3FLoMDHpcfex7esm3hRw5xie6jDzrKpdJ4mLD95wZLdUHXoiw9tJAamG7gaTJb4yiLyGAAKwQah8c2yAoyR5UXtyY6xW3n8vNoWZMmdM/0/*,tprv8ZgxMBicQKsPfFrtXpphYa3nrKfZEQK7UxQJi4oGWXAfhnhuFPa59R628kpptohy3qPsrjNpoVjfDhS8bcf2qdpgnwd4AdzrknrCCv8NSwR/84h/1h/0h/0/*))"</span> sign <span class="nt">--psbt</span> <span class="s2">"cHNidP8BAFIBAAAAAbYAIwZe3vR5knT4afxZvlcgaDi4WH44u3ZBzlTmqqJzAQAAAAD/////AYYmAAAAAAAAFgAU3RacollkleIxk+lz8my/mLCXiH0AAAAAAAEBKxAnAAAAAAAAIgAgmwAxa0LGVYPs2eykyN0unxUM3TQcsIrtXvpWG/IjX+YiAgJhHSuAC4OHocXzeQ0VSVQjaQuxrvTmkb6z0c03e8cO6kgwRQIhAIg27AX8O+bPl7sQE/akEzjj0ngULrlDqIUSNXHwkSfxAiB3vlBdoBqNIAnoTDhVkTT0I9zoiWv6+bsYWNMrYWS8GAEBBUdSIQJhHSuAC4OHocXzeQ0VSVQjaQuxrvTmkb6z0c03e8cO6iEDFeKxKo1lKpXfMZ3UNHaAKNCC+HkdE8E5kk9Epf1yldlSriIGAmEdK4ALg4ehxfN5DRVJVCNpC7Gu9OaRvrPRzTd7xw7qGGkmlypUAACAAQAAgAAAAIAAAAAAAAAAACIGAxXisSqNZSqV3zGd1DR2gCjQgvh5HRPBOZJPRKX9cpXZGKD/bl1UAACAAQAAgAAAAIAAAAAAAAAAAAAA"</span>
<span class="o">{</span>
  <span class="s2">"is_finalized"</span>: <span class="nb">true</span>,
  <span class="s2">"psbt"</span>: <span class="s2">"cHNidP8BAFIBAAAAAbYAIwZe3vR5knT4afxZvlcgaDi4WH44u3ZBzlTmqqJzAQAAAAD/////AYYmAAAAAAAAFgAU3RacollkleIxk+lz8my/mLCXiH0AAAAAAAEBKxAnAAAAAAAAIgAgmwAxa0LGVYPs2eykyN0unxUM3TQcsIrtXvpWG/IjX+YiAgJhHSuAC4OHocXzeQ0VSVQjaQuxrvTmkb6z0c03e8cO6kgwRQIhAIg27AX8O+bPl7sQE/akEzjj0ngULrlDqIUSNXHwkSfxAiB3vlBdoBqNIAnoTDhVkTT0I9zoiWv6+bsYWNMrYWS8GAEiAgMV4rEqjWUqld8xndQ0doAo0IL4eR0TwTmST0Sl/XKV2UgwRQIhAPrrKo7eUj//y2d/q0ewMuPxlJcXPWNYqdKzDTq//g6BAiBS47nKqoxInyAx0k14yH+PGq3MpCjH01AOde9n7chnlAEBBUdSIQJhHSuAC4OHocXzeQ0VSVQjaQuxrvTmkb6z0c03e8cO6iEDFeKxKo1lKpXfMZ3UNHaAKNCC+HkdE8E5kk9Epf1yldlSriIGAmEdK4ALg4ehxfN5DRVJVCNpC7Gu9OaRvrPRzTd7xw7qGGkmlypUAACAAQAAgAAAAIAAAAAAAAAAACIGAxXisSqNZSqV3zGd1DR2gCjQgvh5HRPBOZJPRKX9cpXZGKD/bl1UAACAAQAAgAAAAIAAAAAAAAAAAAEHAAEI3AQASDBFAiEAiDbsBfw75s+XuxAT9qQTOOPSeBQuuUOohRI1cfCRJ/ECIHe+UF2gGo0gCehMOFWRNPQj3OiJa/r5uxhY0ythZLwYAUgwRQIhAPrrKo7eUj//y2d/q0ewMuPxlJcXPWNYqdKzDTq//g6BAiBS47nKqoxInyAx0k14yH+PGq3MpCjH01AOde9n7chnlAFHUiECYR0rgAuDh6HF83kNFUlUI2kLsa705pG+s9HNN3vHDuohAxXisSqNZSqV3zGd1DR2gCjQgvh5HRPBOZJPRKX9cpXZUq4AAA=="</span>
<span class="o">}</span>
</code></pre></div></div> <p>Note that the returned object on the last signature shows the <code class="language-plaintext highlighter-rouge">is_finalized</code> key as <code class="language-plaintext highlighter-rouge">true</code>. This means the psbt is ready to be broadcast.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bdk-cli wallet <span class="nt">--descriptor</span> <span class="s2">"wsh(multi(2,[6926972a/84'/1'/0']tpubDCj3FLoMDHpcfex7esm3hRw5xie6jDzrKpdJ4mLD95wZLdUHXoiw9tJAamG7gaTJb4yiLyGAAKwQah8c2yAoyR5UXtyY6xW3n8vNoWZMmdM/0/*,[a0ff6e5d/84'/1'/0']tpubDCqapM5b7JtmYwt1tcnPnk5e5Wqw6FKYsz1PutkRvmA6G653sCjFr4Qdhncgd4xTmG7BQgJtFkPCxP3jsS7byPUnDaS5FD3Ad7qoEfiamMe/0/*))"</span> broadcast <span class="nt">--psbt</span> <span class="s2">"cHNidP8BAFIBAAAAAbYAIwZe3vR5knT4afxZvlcgaDi4WH44u3ZBzlTmqqJzAQAAAAD/////AYYmAAAAAAAAFgAU3RacollkleIxk+lz8my/mLCXiH0AAAAAAAEBKxAnAAAAAAAAIgAgmwAxa0LGVYPs2eykyN0unxUM3TQcsIrtXvpWG/IjX+YiAgJhHSuAC4OHocXzeQ0VSVQjaQuxrvTmkb6z0c03e8cO6kgwRQIhAIg27AX8O+bPl7sQE/akEzjj0ngULrlDqIUSNXHwkSfxAiB3vlBdoBqNIAnoTDhVkTT0I9zoiWv6+bsYWNMrYWS8GAEiAgMV4rEqjWUqld8xndQ0doAo0IL4eR0TwTmST0Sl/XKV2UgwRQIhAPrrKo7eUj//y2d/q0ewMuPxlJcXPWNYqdKzDTq//g6BAiBS47nKqoxInyAx0k14yH+PGq3MpCjH01AOde9n7chnlAEBBUdSIQJhHSuAC4OHocXzeQ0VSVQjaQuxrvTmkb6z0c03e8cO6iEDFeKxKo1lKpXfMZ3UNHaAKNCC+HkdE8E5kk9Epf1yldlSriIGAmEdK4ALg4ehxfN5DRVJVCNpC7Gu9OaRvrPRzTd7xw7qGGkmlypUAACAAQAAgAAAAIAAAAAAAAAAACIGAxXisSqNZSqV3zGd1DR2gCjQgvh5HRPBOZJPRKX9cpXZGKD/bl1UAACAAQAAgAAAAIAAAAAAAAAAAAEHAAEI3AQASDBFAiEAiDbsBfw75s+XuxAT9qQTOOPSeBQuuUOohRI1cfCRJ/ECIHe+UF2gGo0gCehMOFWRNPQj3OiJa/r5uxhY0ythZLwYAUgwRQIhAPrrKo7eUj//y2d/q0ewMuPxlJcXPWNYqdKzDTq//g6BAiBS47nKqoxInyAx0k14yH+PGq3MpCjH01AOde9n7chnlAFHUiECYR0rgAuDh6HF83kNFUlUI2kLsa705pG+s9HNN3vHDuohAxXisSqNZSqV3zGd1DR2gCjQgvh5HRPBOZJPRKX9cpXZUq4AAA=="</span>
<span class="o">{</span>
  <span class="s2">"txid"</span>: <span class="s2">"948b6d5220043c1343f5569c35c5b33ab7b6159e9c8da5edd0f160a8c711f25d"</span>
<span class="o">}</span>
</code></pre></div></div> <p>That’s it! You can see the final transaction <a href="https://blockstream.info/testnet/tx/948b6d5220043c1343f5569c35c5b33ab7b6159e9c8da5edd0f160a8c711f25d">here</a>.</p> <h2 id="contribute"> <a href="#contribute" class="anchor-heading" aria-labelledby="contribute"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Contribute </h2> <p>If you think this page could use a fix or some additional content, we’d love to hear about it! Feel free to open an issue or a pull request <a href="https://github.com/thunderbiscuit/bitcoindevkit-by-example">here</a>.</p> <script> const toggleDarkMode = document.querySelector('.js-toggle-dark-mode'); jtd.addEvent(toggleDarkMode, 'click', function(){ if (jtd.getTheme() === 'dark') { document.getElementById("cli-logo").src="./img/bash-light.svg"; jtd.setTheme('light'); toggleDarkMode.textContent = 'Come to the dark side'; } else { document.getElementById("cli-logo").src="./img/bash-dark.svg"; jtd.setTheme('dark'); toggleDarkMode.textContent = 'Return to the light side'; } }); </script> </div> </div> <a href="#" id="search-button" class="search-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-search"></use></svg> </a> <div class="search-overlay"></div> </div> </body> </html>
